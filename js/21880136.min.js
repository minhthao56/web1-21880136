async function fetchDataAndBindingView(e,t,n,a){var o=document.getElementById(n),c=await fetch(`${url}${e}`),s=await c.json(),l=Handlebars.templates[`${t}.hbs`],i=a?s:{data:s};if(a){const t=e.split("?"),n=t[1].split("="),a=parseInt(n[1]);i.currentPage=a}o.innerHTML=l(i)}async function getAuthenticate(e,t){const n=await fetch(Url_Authenticate+"/authenticate",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({username:e,password:t})}),a=await n.json();if(200===n.status)return a.token;throw new Error(a.message)}async function login(e){e.preventDefault();const t=document.getElementById("username").value,n=document.getElementById("password").value;try{const e=await getAuthenticate(t,n);localStorage.setItem("token",e),document.getElementsByClassName("btn-close")[0].click(),await checkLogin()}catch(e){document.getElementById("errorMessageLogin").innerText=e}}async function checkLogin(){const e=await verifyToken();controlDisplay(e)}async function verifyToken(){const e=localStorage.getItem("token");if(!e)return!1;const t=await fetch(Url_Authenticate+"/verify",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+e}});return 200===t.status||(localStorage.clear(),!1)}function controlDisplay(e=!0){const t=document.getElementsByClassName("linkLogin"),n=document.getElementsByClassName("linkLogout");let a="flex",o="none";e&&(o="flex",a="none");for(let e=0;e<t.length;e++)t[e].style.display=a,n[e].style.display=o;const c=document.getElementById("form-add-comment");c&&(c.style.display=o)}function logout(){localStorage.clear(),controlDisplay(!1)}async function addComment(e){e.preventDefault();const t={name:document.getElementById("name").value,email:document.getElementById("email").value,comment:document.getElementById("comment").value,blogId:parseInt(document.getElementById("blogId").value),agree:document.getElementById("agree").checked},n=localStorage.getItem("token");try{const e=await fetch(Url_Authenticate+"/comment",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+n},body:JSON.stringify(t)});if(200===e.status)await fetchDataAndBindingView("blogs/"+t.blogId,"blogs-detail-template","blogs-list");else{const t=await e.json();document.getElementById("message-error").innerHTML=t.message}}catch(e){document.getElementById("message-error").innerHTML=e}}const url="https://web1-api.herokuapp.com/api/",Url_Authenticate="https://web1-api.herokuapp.com/users";